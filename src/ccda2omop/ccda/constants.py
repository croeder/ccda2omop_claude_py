# Copyright 2025 Christophe Roeder. All rights reserved.

"""C-CDA Section Template OIDs and other constants."""

# C-CDA Section Template OIDs
OID_ENCOUNTERS = "2.16.840.1.113883.10.20.22.2.22"
OID_ENCOUNTERS_ENTRIES_REQ = "2.16.840.1.113883.10.20.22.2.22.1"
OID_PROBLEMS = "2.16.840.1.113883.10.20.22.2.5"
OID_PROBLEMS_ENTRIES_REQ = "2.16.840.1.113883.10.20.22.2.5.1"
OID_MEDICATIONS = "2.16.840.1.113883.10.20.22.2.1"
OID_MEDICATIONS_ENTRIES_REQ = "2.16.840.1.113883.10.20.22.2.1.1"
OID_PROCEDURES = "2.16.840.1.113883.10.20.22.2.7"
OID_PROCEDURES_ENTRIES_REQ = "2.16.840.1.113883.10.20.22.2.7.1"
OID_VITAL_SIGNS = "2.16.840.1.113883.10.20.22.2.4"
OID_VITAL_SIGNS_ENTRIES_REQ = "2.16.840.1.113883.10.20.22.2.4.1"
OID_RESULTS = "2.16.840.1.113883.10.20.22.2.3"
OID_RESULTS_ENTRIES_REQ = "2.16.840.1.113883.10.20.22.2.3.1"
OID_ALLERGIES = "2.16.840.1.113883.10.20.22.2.6"
OID_ALLERGIES_ENTRIES_REQ = "2.16.840.1.113883.10.20.22.2.6.1"
OID_IMMUNIZATIONS = "2.16.840.1.113883.10.20.22.2.2"
OID_IMMUNIZATIONS_ENTRIES_REQ = "2.16.840.1.113883.10.20.22.2.2.1"
OID_MEDICAL_EQUIPMENT = "2.16.840.1.113883.10.20.22.2.23"
OID_SOCIAL_HISTORY = "2.16.840.1.113883.10.20.22.2.17"

# Set of known section OIDs for lookup
KNOWN_SECTION_OIDS = {
    OID_ENCOUNTERS,
    OID_ENCOUNTERS_ENTRIES_REQ,
    OID_PROBLEMS,
    OID_PROBLEMS_ENTRIES_REQ,
    OID_MEDICATIONS,
    OID_MEDICATIONS_ENTRIES_REQ,
    OID_PROCEDURES,
    OID_PROCEDURES_ENTRIES_REQ,
    OID_VITAL_SIGNS,
    OID_VITAL_SIGNS_ENTRIES_REQ,
    OID_RESULTS,
    OID_RESULTS_ENTRIES_REQ,
    OID_ALLERGIES,
    OID_ALLERGIES_ENTRIES_REQ,
    OID_IMMUNIZATIONS,
    OID_IMMUNIZATIONS_ENTRIES_REQ,
    OID_MEDICAL_EQUIPMENT,
    OID_SOCIAL_HISTORY,
}

# Mapping from section OID to section name
SECTION_OID_TO_NAME = {
    OID_ENCOUNTERS: "Encounters",
    OID_ENCOUNTERS_ENTRIES_REQ: "Encounters",
    OID_PROBLEMS: "Problems",
    OID_PROBLEMS_ENTRIES_REQ: "Problems",
    OID_MEDICATIONS: "Medications",
    OID_MEDICATIONS_ENTRIES_REQ: "Medications",
    OID_PROCEDURES: "Procedures",
    OID_PROCEDURES_ENTRIES_REQ: "Procedures",
    OID_VITAL_SIGNS: "VitalSigns",
    OID_VITAL_SIGNS_ENTRIES_REQ: "VitalSigns",
    OID_RESULTS: "LabResults",
    OID_RESULTS_ENTRIES_REQ: "LabResults",
    OID_ALLERGIES: "Allergies",
    OID_ALLERGIES_ENTRIES_REQ: "Allergies",
    OID_IMMUNIZATIONS: "Immunizations",
    OID_IMMUNIZATIONS_ENTRIES_REQ: "Immunizations",
    OID_MEDICAL_EQUIPMENT: "Devices",
    OID_SOCIAL_HISTORY: "Observations",
}

# OIDs that indicate "entries required" (strict) templates
ENTRIES_REQUIRED_OIDS = {
    OID_ENCOUNTERS_ENTRIES_REQ,
    OID_PROBLEMS_ENTRIES_REQ,
    OID_MEDICATIONS_ENTRIES_REQ,
    OID_PROCEDURES_ENTRIES_REQ,
    OID_VITAL_SIGNS_ENTRIES_REQ,
    OID_RESULTS_ENTRIES_REQ,
    OID_ALLERGIES_ENTRIES_REQ,
    OID_IMMUNIZATIONS_ENTRIES_REQ,
}
